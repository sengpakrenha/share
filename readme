wget https://packages.wazuh.com/4.x/apt/pool/main/w/wazuh-agent/wazuh-agent_4.8.2-1_aarch64.deb
------
sudo WAZUH_MANAGER='192.168.13.177' \
WAZUH_AGENT_GROUP='default' \
WAZUH_AGENT_NAME='raspberry1' \
dpkg -i ./wazuh-agent_4.8.2-1_aarch64.deb
--------
sudo systemctl enable wazuh-agent
sudo systemctl start wazuh-agent
-------
sudo systemctl status wazuh-agent
--------------------------------
wget https://packages.wazuh.com/4.x/apt/pool/main/w/wazuh-agent/wazuh-agent_4.8.2-1_amd64.deb && sudo WAZUH_MANAGER='192.168.13.177' WAZUH_AGENT_GROUP='default' WAZUH_AGENT_NAME='ubuntu-esxi' dpkg -i ./wazuh-agent_4.8.2-1_amd64.deb





TOKEN=$(curl -sk -u wazuh-wui:wazuh-wui https://127.0.0.1:55000/security/user/authenticate?raw=true)
curl -sk -H "Authorization: Bearer $TOKEN" https://127.0.0.1:55000/manager/status?pretty


# Current breaker limits & defaults
curl -ku admin:c5uUuWDF0fXzx2nAc1+Yg*if3vZI+T.X https://127.0.0.1:9200/_cluster/settings?include_defaults=true | jq '.defaults.indices.breaker'

# Heap & mem stats
curl -ku admin:c5uUuWDF0fXzx2nAc1+Yg*if3vZI+T.X https://127.0.0.1:9200/_nodes/stats/jvm?pretty | jq '.nodes[].jvm.mem | {heap_used_in_bytes, heap_max_in_bytes}'

sudo sed -i 's/^-Xms.*/-Xms2g/; s/^-Xmx.*/-Xmx2g/' /etc/wazuh-indexer/jvm.options
echo 'vm.max_map_count=262144' | sudo tee /etc/sysctl.d/99-wazuh-indexer.conf
sudo sysctl --system


# OpenSearch needs high nofile
ulimit -n    # should be >= 65536 (systemd override above sets it)

# Make sure the data/pid/log dirs are owned by the indexer user (varies by install)
sudo chown -R wazuh-indexer:wazuh-indexer /var/lib/wazuh-indexer /var/log/wazuh-indexer /var/run/wazuh-indexer 2>/dev/null || true



grep -n 'bootstrap.memory_lock' /etc/wazuh-indexer/opensearch.yml
grep -n 'network.host\|cluster.name\|node.name' /etc/wazuh-indexer/opensearch.yml
# (there should be only one of each; YAML indentation must be spaces, not tabs)
